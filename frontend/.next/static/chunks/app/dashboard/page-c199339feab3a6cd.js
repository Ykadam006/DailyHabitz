(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{1164:(e,t,a)=>{Promise.resolve().then(a.bind(a,7716))},5731:(e,t,a)=>{"use strict";a.d(t,{$0:()=>i,WV:()=>d,c$:()=>o,uc:()=>c,wK:()=>u,z5:()=>l});let s="https://dailyhabitz.onrender.com",r="".concat(s,"/habits"),n="".concat(s,"/health");async function i(){try{await fetch(n)}catch(e){}}async function l(e){let t=await fetch(r,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error("Failed to create habit");return t.json()}async function o(e){let t=await fetch("".concat(r,"?userId=").concat(e));if(!t.ok)throw Error("Failed to fetch habits");return t.json()}let d=async e=>{let t=await fetch("".concat(r,"/").concat(e,"/done"),{method:"POST",headers:{"Content-Type":"application/json"}});if(!t.ok){let e=await t.json();throw Error((null==e?void 0:e.error)||"Failed to mark habit as done")}return t.json()};async function c(e){if(!(await fetch("".concat(r,"/").concat(e),{method:"DELETE"})).ok)throw Error("Failed to delete habit")}async function u(e,t){let a=await fetch("".concat(r,"/").concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!a.ok)throw Error("Failed to update habit");return a.json()}},7716:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>j});var s=a(5155),r=a(2115),n=a(6715),i=a(2960),l=a(5041),o=a(5731);let d=["habits"];function c(e){var t;let a=(0,n.jE)(),s=(0,i.I)({queryKey:[...d,e],queryFn:()=>(0,o.c$)(e),enabled:!!e}),r=(0,l.n)({mutationFn:e=>(0,o.z5)(e),onMutate:async t=>{await a.cancelQueries({queryKey:[...d,e]});let s=a.getQueryData([...d,e]),r={_id:"temp-".concat(Date.now()),title:t.title,frequency:t.frequency,notes:t.notes,currentStreak:0,xp:0,completedDates:[],isSaving:!0};return a.setQueryData([...d,e],function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return[...e,r]}),{previous:s}},onSuccess:t=>{a.setQueryData([...d,e],function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.map(e=>e._id.startsWith("temp-")&&e.isSaving?{...t,isSaving:void 0}:e)})},onError:(t,s,r)=>{(null==r?void 0:r.previous)&&a.setQueryData([...d,e],r.previous)},onSettled:()=>{a.invalidateQueries({queryKey:[...d,e]})}}),c=(0,l.n)({mutationFn:e=>{let{id:t,data:a}=e;return(0,o.wK)(t,a)},onSuccess:()=>{a.invalidateQueries({queryKey:[...d,e]})}}),u=(0,l.n)({mutationFn:o.uc,onSuccess:()=>{a.invalidateQueries({queryKey:[...d,e]})}}),m=(0,l.n)({mutationFn:o.WV,onSuccess:()=>{a.invalidateQueries({queryKey:[...d,e]})}});return{habits:null!=(t=s.data)?t:[],isLoading:s.isLoading,isFetching:s.isFetching,error:s.error,refetch:s.refetch,createMutation:r,updateMutation:c,deleteMutation:u,markDoneMutation:m}}var u=a(6671);function m(e){let{userId:t}=e,[a,n]=(0,r.useState)(""),[i,l]=(0,r.useState)("daily"),[o,d]=(0,r.useState)(""),{createMutation:m}=c(t);return(0,s.jsxs)("form",{onSubmit:e=>{e.preventDefault(),m.mutate({title:a,frequency:i,notes:o,userId:t},{onSuccess:()=>{n(""),l("daily"),d("")},onError:()=>{u.o.error("Failed to create habit")}})},className:"bg-white border border-gray-200 p-6 rounded-xl shadow-xl max-w-xl mx-auto",children:[(0,s.jsx)("h2",{className:"text-2xl font-semibold mb-4 text-[#006d77]",children:"Create a New Habit"}),(0,s.jsx)("input",{type:"text",placeholder:"Habit title",className:"w-full px-4 py-2 mb-3 rounded-lg border border-gray-300 text-gray-900 focus:outline-none focus:ring-2 focus:ring-[#006d77] transition",value:a,onChange:e=>n(e.target.value),required:!0,disabled:m.isPending}),(0,s.jsxs)("select",{value:i,onChange:e=>l(e.target.value),className:"w-full px-4 py-2 mb-3 rounded-lg border border-gray-300 bg-white text-gray-900 focus:outline-none focus:ring-2 focus:ring-[#006d77] transition",disabled:m.isPending,children:[(0,s.jsx)("option",{value:"daily",children:"Daily"}),(0,s.jsx)("option",{value:"weekly",children:"Weekly"})]}),(0,s.jsx)("textarea",{placeholder:"Notes (optional)",className:"w-full px-4 py-2 mb-4 rounded-lg border border-gray-300 text-gray-900 focus:outline-none focus:ring-2 focus:ring-[#006d77] transition",value:o,onChange:e=>d(e.target.value)}),(0,s.jsx)("button",{type:"submit",disabled:m.isPending,className:"w-full py-2 bg-[#006d77] hover:bg-[#005258] text-white font-medium rounded-lg transition disabled:opacity-70",children:m.isPending?"Adding...":"Add Habit"})]})}function h(e){let{habit:t,onClose:a,onSave:n,isSaving:i=!1}=e,[l,o]=(0,r.useState)(t.title),[d,c]=(0,r.useState)(t.frequency),[u,m]=(0,r.useState)(t.notes||"");return(0,s.jsxs)("form",{onSubmit:e=>{e.preventDefault(),n({title:l,frequency:d,notes:u})},className:"bg-white p-5 rounded-2xl shadow-md border border-[#d1e8e2] mt-2 space-y-4",children:[(0,s.jsx)("h3",{className:"text-xl font-semibold text-[#243E36]",children:"Edit Habit"}),(0,s.jsx)("input",{className:"w-full px-4 py-2 text-gray-900 rounded-lg border focus:outline-none focus:ring-2 focus:ring-[#006d77]",value:l,onChange:e=>o(e.target.value),required:!0,placeholder:"Habit title"}),(0,s.jsxs)("select",{className:"w-full px-4 py-2 text-gray-900 rounded-lg border bg-white focus:outline-none focus:ring-2 focus:ring-[#006d77]",value:d,onChange:e=>c(e.target.value),children:[(0,s.jsx)("option",{value:"daily",children:"Daily"}),(0,s.jsx)("option",{value:"weekly",children:"Weekly"})]}),(0,s.jsx)("textarea",{className:"w-full px-4 py-2 text-gray-900 rounded-lg border focus:outline-none focus:ring-2 focus:ring-[#006d77]",value:u,onChange:e=>m(e.target.value),placeholder:"Optional notes..."}),(0,s.jsxs)("div",{className:"flex justify-end gap-3 pt-3",children:[(0,s.jsx)("button",{type:"button",onClick:a,className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition",children:"Cancel"}),(0,s.jsx)("button",{type:"submit",disabled:i,className:"px-4 py-2 bg-[#243E36] text-white rounded-lg hover:bg-[#1b2c28] transition disabled:opacity-70",children:i?"Saving...":"Save"})]})]})}var x=a(4288),g=a(2132),b=a(3898),y=a(6694);function p(e){let{completedDates:t}=e,a=(0,x.R)(),r=Array.from({length:35},(e,t)=>(0,g.e)(a,35-t-1));return(0,s.jsxs)("div",{className:"mt-4 bg-white p-4 rounded-lg shadow-md border border-gray-200",children:[(0,s.jsx)("div",{className:"grid grid-cols-7 text-sm font-medium text-center text-gray-600 mb-2",children:["S","M","T","W","T","F","S"].map((e,t)=>(0,s.jsx)("div",{className:"uppercase",children:e},t))}),(0,s.jsx)("div",{className:"grid grid-cols-7 gap-1 text-center text-xs",children:r.map((e,a)=>{let r=t.some(t=>(0,b.r)(new Date(t),e));return(0,s.jsx)("div",{title:(0,y.GP)(e,"PPP"),className:"flex items-center justify-center h-8 rounded-md transition-colors duration-150 ".concat(r?"bg-green-500 text-white":"bg-gray-100 text-gray-500"," hover:ring-2 hover:ring-offset-1 hover:ring-green-400"),children:(0,y.GP)(e,"d")},a)})})]})}function f(){return(0,s.jsxs)("div",{className:"border border-gray-200 bg-white p-5 rounded-xl shadow-md animate-pulse","aria-hidden":!0,children:[(0,s.jsxs)("div",{className:"flex justify-between items-start",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("div",{className:"h-6 bg-gray-200 rounded w-3/4 mb-2"}),(0,s.jsx)("div",{className:"h-4 bg-gray-100 rounded w-1/4 mb-2"}),(0,s.jsx)("div",{className:"h-4 bg-gray-100 rounded w-1/2 mb-2"}),(0,s.jsx)("div",{className:"h-4 bg-gray-100 rounded w-1/3 mt-3"})]}),(0,s.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,s.jsx)("div",{className:"h-8 w-20 bg-gray-200 rounded"}),(0,s.jsx)("div",{className:"h-8 w-14 bg-gray-200 rounded"}),(0,s.jsx)("div",{className:"h-8 w-16 bg-gray-200 rounded"})]})]}),(0,s.jsx)("div",{className:"mt-4 grid grid-cols-7 gap-1",children:Array.from({length:35}).map((e,t)=>(0,s.jsx)("div",{className:"h-8 rounded-md bg-gray-100"},t))})]})}function v(e){let{userId:t}=e,[a,n]=(0,r.useState)(null),[i,l]=(0,r.useState)(null),{habits:o,isLoading:d,isFetching:m,updateMutation:x,deleteMutation:g,markDoneMutation:b}=c(t),y=e=>{e.startsWith("temp-")||(l(e),b.mutate(e,{onSettled:()=>l(null),onError:e=>{u.o.error(e instanceof Error?e.message:"Failed to mark done")}}))},v=e=>{!e.startsWith("temp-")&&confirm("Are you sure you want to delete this habit?")&&(l(e),g.mutate(e,{onSettled:()=>l(null),onError:()=>u.o.error("Failed to delete habit")}))},j=(e,t)=>{x.mutate({id:e,data:t},{onSuccess:()=>{n(null)},onError:()=>{u.o.error("Failed to update habit")}})};return d&&0===o.length?(0,s.jsxs)("div",{className:"space-y-6 mt-8",children:[(0,s.jsx)(f,{}),(0,s.jsx)(f,{}),(0,s.jsx)(f,{})]}):0===o.length?(0,s.jsx)("p",{className:"mt-6 text-center text-gray-500",children:"No habits yet. Start by adding one!"}):(0,s.jsxs)("div",{className:"space-y-6 mt-8",children:[m&&o.length>0&&(0,s.jsx)("div",{className:"text-xs text-gray-500 text-center","aria-live":"polite",children:"Syncing..."}),o.map(e=>{var t,r;return(0,s.jsx)("div",{className:"border border-gray-200 bg-white p-5 rounded-xl shadow-md hover:shadow-lg transition-all ".concat(e.isSaving?"opacity-80":""),children:a===e._id?(0,s.jsx)(h,{habit:e,onClose:()=>n(null),onSave:t=>j(e._id,t),isSaving:x.isPending}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex justify-between items-start",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h3",{className:"text-xl font-bold text-[#243E36] mb-1 flex items-center gap-2",children:[e.title,e.isSaving&&(0,s.jsx)("span",{className:"text-xs text-amber-600 font-normal",children:"Saving..."})]}),(0,s.jsx)("p",{className:"text-sm text-[#7CA982] mb-1",children:e.frequency}),e.notes&&(0,s.jsx)("p",{className:"text-sm text-gray-600 italic mb-1",children:e.notes}),(0,s.jsxs)("p",{className:"text-sm mt-2 text-[#006d77]",children:["Streak:"," ",(0,s.jsx)("span",{className:"font-semibold",children:null!=(t=e.currentStreak)?t:0})," ","| XP: ",(0,s.jsx)("span",{className:"font-semibold",children:null!=(r=e.xp)?r:0})]})]}),(0,s.jsxs)("div",{className:"flex flex-col space-y-2 items-end",children:[(0,s.jsx)("button",{onClick:()=>y(e._id),disabled:i===e._id||!!e.isSaving,className:"text-green-600 hover:text-green-700 text-sm font-medium disabled:opacity-50",children:"Mark Done"}),(0,s.jsx)("button",{onClick:()=>n(e._id),disabled:!!e.isSaving,className:"text-blue-600 hover:text-blue-700 text-sm font-medium disabled:opacity-50",children:"Edit"}),(0,s.jsx)("button",{onClick:()=>v(e._id),disabled:i===e._id||!!e.isSaving,className:"text-red-500 hover:text-red-600 text-sm font-medium disabled:opacity-50",children:"Delete"})]})]}),Array.isArray(e.completedDates)&&e.completedDates.length>0&&(0,s.jsx)("div",{className:"mt-4",children:(0,s.jsx)(p,{completedDates:e.completedDates})})]})},e._id)})]})}function j(){let e="default-user";return(0,s.jsx)("main",{className:"min-h-screen bg-[#f1f7ed] px-6 py-12",children:(0,s.jsxs)("div",{className:"max-w-3xl mx-auto",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold mb-4 text-[#243E36]",children:"\uD83D\uDC4B Welcome to DailyHabitz!"}),(0,s.jsx)(m,{userId:e}),(0,s.jsx)(v,{userId:e})]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[940,350,441,684,358],()=>t(1164)),_N_E=e.O()}]);